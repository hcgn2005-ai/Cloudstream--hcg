plugins {
    id("java-library")
    id("org.jetbrains.kotlin.jvm") version "1.8.0"
}

version = "1.0.0"

repositories {
    mavenCentral()
    google()
    maven("https://jitpack.io")
}

dependencies {
    implementation("com.lagradost:cloudstream3:pre-release")
    implementation("org.jetbrains.kotlin:kotlin-stdlib:1.8.0")
    implementation("com.github.Blatzar:NiceHttp:0.3.2")
    implementation("org.jsoup:jsoup:1.13.1")
}

java {
    sourceCompatibility = JavaVersion.VERSION_11
    targetCompatibility = JavaVersion.VERSION_11
}

tasks.jar {
    archiveFileName.set("hcgn2005-ai-vidbox-plugin.jar")
    manifest {
        attributes(
            "Implementation-Title" to "VidBox Plugin by hcgn2005-ai",
            "Implementation-Version" to version
        )
    }
    
    // Include all dependencies in the JAR
    from(configurations.runtimeClasspath.get().map { if (it.isDirectory) it else zipTree(it) })
    
    // Remove signature files to avoid conflicts
    exclude("META-INF/*.RSA", "META-INF/*.SF", "META-INF/*.DSA")
    
    duplicatesStrategy = DuplicatesStrategy.INCLUDE
}
